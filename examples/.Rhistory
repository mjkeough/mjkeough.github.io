knitr::opts_chunk$set(echo = TRUE)
source("../R/libraries.R")   #This is the common library
library(performance)
mayekar <- read.csv("../data/mayekar.csv")
mayekar
#select rh = low
mayekar1 <- subset(mayekar, rh=="low")
plot(colnum~timepup, data=mayekar1)
plot(colnum~weight, data=mayekar1)
mayekar1.glm <- glm(colnum ~ timepup*weight*sex,data=mayekar1,family=binomial)
tidy(mayekar1.glm)
glance(mayekar1.glm)
AICc(mayekar1.glm)
vif(lm(colnum ~ timepup*weight*sex, data=mayekar1))
cor(mayekar1$timepup,mayekar1$weight)
aov1 <-aov(timepup~sex, data=mayekar1)
summary(aov1)
aov2 <- aov(weight~sex, data=mayekar1)
summary(aov2)
mayekar1$ctimepup <- scale(mayekar1$timepup, center=TRUE, scale=FALSE)
mayekar1$cweight <- scale(mayekar1$weight, center=TRUE, scale=FALSE)
vif(lm(colnum ~ ctimepup*cweight*sex, data=mayekar1))
mayekar2.glm <- glm(colnum ~ ctimepup*cweight*sex,data=mayekar1,family=binomial)
summary(mayekar2.glm)
AICc(mayekar2.glm)
mayekar3.glm <- glm(colnum ~ ctimepup+cweight+sex,data=mayekar1,family=binomial)
summary(mayekar3.glm)
AICc(mayekar3.glm)
anova(mayekar2.glm, mayekar3.glm, test = 'Chisq')
mayekar4.glm <- glm(colnum ~ timepup+weight+sex,data=mayekar1,family=binomial)
anova(mayekar1.glm, mayekar4.glm, test = 'Chisq')
summary(mayekar4.glm)
AICc(mayekar4.glm)
confint(mayekar4.glm)
anova(mayekar4.glm, test = 'Chisq')
mayekar5.glm <- glm(colnum ~ timepup+weight,data=mayekar1,family=binomial)
mayekar6.glm <- glm(colnum ~ timepup+sex,data=mayekar1,family=binomial)
mayekar7.glm <- glm(colnum ~ weight+sex,data=mayekar1,family=binomial)
lrtest(mayekar5.glm, mayekar4.glm)
lrtest(mayekar6.glm, mayekar4.glm)
lrtest(mayekar7.glm, mayekar4.glm)
residuals(mayekar4.glm, type="deviance")
residualPlots(mayekar4.glm, type="deviance")
influencePlot(mayekar4.glm)
exp(coef(mayekar4.glm))
exp(confint.default(mayekar4.glm))
avPlots(mayekar4.glm)
performance_hosmer(mayekar4.glm, n_bins=10)
r2_tjur(mayekar4.glm)
mayekar4.glm <- glm(colnum ~ timepup+weight+sex,data=mayekar1,family=binomial)
summary(mayekar4.glm)
AICc(mayekar.glm)
mayekar4.glm <- glm(colnum ~ timepup+weight+sex,data=mayekar1,family=binomial)
summary(mayekar4.glm)
AICc(mayekar4.glm)
knitr::opts_chunk$set(echo = TRUE)
source("../R/libraries.R")   #This is the common library
library(performance)
mayekar <- read.csv("../data/mayekar.csv")
mayekar
#select rh = low
mayekar1 <- subset(mayekar, rh=="low")
plot(colnum~timepup, data=mayekar1)
plot(colnum~weight, data=mayekar1)
mayekar1.glm <- glm(colnum ~ timepup*weight*sex,data=mayekar1,family=binomial)
tidy(mayekar1.glm)
glance(mayekar1.glm)
AICc(mayekar1.glm)
vif(lm(colnum ~ timepup*weight*sex, data=mayekar1))
cor(mayekar1$timepup,mayekar1$weight)
aov1 <-aov(timepup~sex, data=mayekar1)
summary(aov1)
aov2 <- aov(weight~sex, data=mayekar1)
summary(aov2)
mayekar1$ctimepup <- scale(mayekar1$timepup, center=TRUE, scale=FALSE)
mayekar1$cweight <- scale(mayekar1$weight, center=TRUE, scale=FALSE)
vif(lm(colnum ~ ctimepup*cweight*sex, data=mayekar1))
mayekar2.glm <- glm(colnum ~ ctimepup*cweight*sex,data=mayekar1,family=binomial)
summary(mayekar2.glm)
AICc(mayekar2.glm)
mayekar3.glm <- glm(colnum ~ ctimepup+cweight+sex,data=mayekar1,family=binomial)
summary(mayekar3.glm)
AICc(mayekar3.glm)
anova(mayekar2.glm, mayekar3.glm, test = 'Chisq')
mayekar4.glm <- glm(colnum ~ timepup+weight+sex,data=mayekar1,family=binomial)
summary(mayekar4.glm)
AICc(mayekar4.glm)
anova(mayekar1.glm, mayekar4.glm, test = 'Chisq')
summary(mayekar4.glm)
AICc(mayekar4.glm)
confint(mayekar4.glm)
anova(mayekar4.glm, test = 'Chisq')
mayekar5.glm <- glm(colnum ~ timepup+weight,data=mayekar1,family=binomial)
mayekar6.glm <- glm(colnum ~ timepup+sex,data=mayekar1,family=binomial)
mayekar7.glm <- glm(colnum ~ weight+sex,data=mayekar1,family=binomial)
lrtest(mayekar5.glm, mayekar4.glm)
lrtest(mayekar6.glm, mayekar4.glm)
lrtest(mayekar7.glm, mayekar4.glm)
residuals(mayekar4.glm, type="deviance")
residualPlots(mayekar4.glm, type="deviance")
influencePlot(mayekar4.glm)
exp(coef(mayekar4.glm))
exp(confint.default(mayekar4.glm))
avPlots(mayekar4.glm)
performance_hosmer(mayekar4.glm, n_bins=10)
r2_tjur(mayekar4.glm)
knitr::opts_chunk$set(echo = TRUE)
source("../R/libraries.R")   #This is the common library
library(performance)
library(statmod)
library(vcd)
library(pscl)
fill <- read.csv("../data/fill.csv")
fill
plot(table(fill$culm))
boxplot(culm~treatment, data=fill)
summarySE(data=fill, measurevar="culm", groupvars=c("treatment"))
fill1.glm <- glm(culm~basalarea+treatment+basalarea*treatment, family=poisson, data=fill)
summary(fill1.glm)
AICc(fill1.glm)
residualPlots(fill1.glm, type="deviance")
residuals(fill1.glm, type="deviance")
influence.measures(fill1.glm)
influencePlot(fill1.glm)
vif(lm(culm ~ basalarea+treatment+basalarea*treatment, data=fill))
fill2.glm <- glm(culm~basalarea+treatment, family=poisson, data=fill)
lrtest(fill1.glm, fill2.glm)
anova(fill1.glm, test="LRT")
presid1 <- resid(fill1.glm, type="pearson")
ssize1 <- nrow(fill)
params1 <- length(coef(fill1.glm))
disp1 <- sum(presid1^2)/(ssize1-params1)
disp1
fill1.nb <- glm.nb(culm~basalarea+treatment+basalarea*treatment, data=fill)
summary(fill1.nb)
AICc(fill1.nb)
fill2.nb <- glm.nb(culm~basalarea+treatment, data=fill)
lrtest(fill1.nb, fill2.nb)
summary(fill2.nb)
AIC(fill2.nb)
fill3.nb <- glm.nb(culm~basalarea, data=fill)
lrtest(fill2.nb, fill3.nb)
fill4.nb <- glm.nb(culm~treatment, data=fill)
lrtest(fill2.nb, fill4.nb)
anova(fill1.nb, test="LRT")
residualPlots(fill1.nb, type="deviance")
influence.measures(fill1.nb)
influencePlot(fill1.nb)
nbresid <- resid(fill1.nb, type="pearson")
nbssize <- nrow(fill)
nbparams <- length(coef(fill1.nb))+1
nbdisp <- sum(nbresid^2)/(nbssize-nbparams)
nbdisp
fill.qp <- glm(culm~basalarea+treatment+basalarea*treatment, family=quasipoisson, data=fill)
fill.qp$theta
summary(fill.qp)
anova(fill.qp, test="LRT")
residualPlots(fill.qp, type="deviance")
influence.measures(fill.qp)
influencePlot(fill.qp)
zerobs <- fill$culm == 0
propzerobs <- sum(zerobs)/nrow(fill)
propzerobs
munb <- exp(predict(fill2.nb))
theta <- fill2.nb$theta
znb <- dnbinom(0, mu=munb, size=theta)
mean(znb)
fill1.zip <- zeroinfl(culm~basalarea+treatment|1, data=fill, dist="negbin")
summary(fill1.zip)
AIC(fill1.zip)
fill2.zip <- zeroinfl(culm~basalarea+treatment|basalarea+treatment, data=fill, dist="negbin")
summary(fill2.zip)
AIC(fill2.zip)
lrtest(fill1.zip, fill2.zip)
fill.lm <- lm(culm~basalarea+treatment+basalarea*treatment, data=fill)
summary(fill.lm)
plot(fill.lm)
AIC(fill.lm)
fill.lm <- lm(sqrt(culm)~basalarea+treatment+basalarea*treatment, data=fill)
summary(fill.lm)
plot(fill.lm)
AIC(fill.lm)
fill1.nb <- glm.nb(culm~basalarea+treatment+basalarea*treatment, data=fill)
summary(fill1.nb)
AICc(fill1.nb)
fill2.nb <- glm.nb(culm~basalarea+treatment, data=fill)
lrtest(fill1.nb, fill2.nb)
summary(fill2.nb)
AIC(fill2.nb)
fill3.nb <- glm.nb(culm~basalarea, data=fill)
lrtest(fill2.nb, fill3.nb)
fill4.nb <- glm.nb(culm~treatment, data=fill)
lrtest(fill2.nb, fill4.nb)
anova(fill1.nb, test="LRT")
fill1.nb <- glm.nb(culm~basalarea+treatment+basalarea*treatment, data=fill)
summary(fill1.nb)
AICc(fill1.nb)
fill2.nb <- glm.nb(culm~basalarea+treatment, data=fill)
lrtest(fill1.nb, fill2.nb)
summary(fill2.nb)
AICc(fill2.nb)
fill3.nb <- glm.nb(culm~basalarea, data=fill)
summary(fill3.nb)
AICc(fill3.nb)
lrtest(fill2.nb, fill3.nb)
fill4.nb <- glm.nb(culm~treatment, data=fill)
lrtest(fill2.nb, fill4.nb)
anova(fill1.nb, test="LRT")
glimpse(fill3.nb)
glance(fill3.nb)
tidy(fill3.nb)
fill1.nb <- glm.nb(culm~basalarea+treatment+basalarea*treatment, data=fill)
summary(fill1.nb)
AICc(fill1.nb)
fill2.nb <- glm.nb(culm~basalarea+treatment, data=fill)
lrtest(fill1.nb, fill2.nb)
summary(fill2.nb)
AICc(fill2.nb)
fill3.nb <- glm.nb(culm~basalarea, data=fill)
summary(fill3.nb)
AICc(fill3.nb)
lrtest(fill2.nb, fill3.nb)
fill4.nb <- glm.nb(culm~treatment, data=fill)
lrtest(fill2.nb, fill4.nb)
anova(fill1.nb, test="LRT")
knitr::opts_chunk$set(echo = TRUE)
source("../R/libraries.R")   #This is the common library
library(performance)
library(statmod)
library(vcd)
library(pscl)
fill <- read.csv("../data/fill.csv")
fill
plot(table(fill$culm))
boxplot(culm~treatment, data=fill)
summarySE(data=fill, measurevar="culm", groupvars=c("treatment"))
fill1.glm <- glm(culm~basalarea+treatment+basalarea*treatment, family=poisson, data=fill)
summary(fill1.glm)
AICc(fill1.glm)
residualPlots(fill1.glm, type="deviance")
residuals(fill1.glm, type="deviance")
influence.measures(fill1.glm)
influencePlot(fill1.glm)
vif(lm(culm ~ basalarea+treatment+basalarea*treatment, data=fill))
fill2.glm <- glm(culm~basalarea+treatment, family=poisson, data=fill)
lrtest(fill1.glm, fill2.glm)
anova(fill1.glm, test="LRT")
presid1 <- resid(fill1.glm, type="pearson")
ssize1 <- nrow(fill)
params1 <- length(coef(fill1.glm))
disp1 <- sum(presid1^2)/(ssize1-params1)
disp1
fill1.nb <- glm.nb(culm~basalarea+treatment+basalarea*treatment, data=fill)
summary(fill1.nb)
AICc(fill1.nb)
fill2.nb <- glm.nb(culm~basalarea+treatment, data=fill)
lrtest(fill1.nb, fill2.nb)
summary(fill2.nb)
AICc(fill2.nb)
fill3.nb <- glm.nb(culm~basalarea, data=fill)
summary(fill3.nb)
AICc(fill3.nb)
lrtest(fill2.nb, fill3.nb)
fill4.nb <- glm.nb(culm~treatment, data=fill)
lrtest(fill2.nb, fill4.nb)
anova(fill1.nb, test="LRT")
residualPlots(fill1.nb, type="deviance")
influence.measures(fill1.nb)
influencePlot(fill1.nb)
nbresid <- resid(fill1.nb, type="pearson")
nbssize <- nrow(fill)
nbparams <- length(coef(fill1.nb))+1
nbdisp <- sum(nbresid^2)/(nbssize-nbparams)
nbdisp
fill.qp <- glm(culm~basalarea+treatment+basalarea*treatment, family=quasipoisson, data=fill)
fill.qp$theta
summary(fill.qp)
anova(fill.qp, test="LRT")
residualPlots(fill.qp, type="deviance")
influence.measures(fill.qp)
influencePlot(fill.qp)
zerobs <- fill$culm == 0
propzerobs <- sum(zerobs)/nrow(fill)
propzerobs
munb <- exp(predict(fill2.nb))
theta <- fill2.nb$theta
znb <- dnbinom(0, mu=munb, size=theta)
mean(znb)
fill1.zip <- zeroinfl(culm~basalarea+treatment|1, data=fill, dist="negbin")
summary(fill1.zip)
AIC(fill1.zip)
fill2.zip <- zeroinfl(culm~basalarea+treatment|basalarea+treatment, data=fill, dist="negbin")
summary(fill2.zip)
AIC(fill2.zip)
lrtest(fill1.zip, fill2.zip)
fill.lm <- lm(culm~basalarea+treatment+basalarea*treatment, data=fill)
summary(fill.lm)
plot(fill.lm)
AIC(fill.lm)
fill.lm <- lm(sqrt(culm)~basalarea+treatment+basalarea*treatment, data=fill)
summary(fill.lm)
plot(fill.lm)
AIC(fill.lm)
library(vegan)
knitr::opts_chunk$set(echo = TRUE)
parkinson <- read.csv("../data/park2002.csv")
head(parkinson,10)
park <- read.csv("../data/park2020.csv")
park1 <- park[,-(1:3)]
park1.sim <- simper(park1, park$treat, permutations=1000)
summary(park1.sim)
park1s <- wisconsin(park1)
park1s.sim <- simper(park1s, park$treat, permutations=10000)
summary(park1s.sim)
install.packages("rdacca.hp")
